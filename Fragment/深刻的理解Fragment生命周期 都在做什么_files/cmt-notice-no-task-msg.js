!function(){function t(t){return"[object Function]"===Object.prototype.toString.call(t)}function e(e,i,n){if(a[e])throw new Error("Module "+e+" has been defined already.");t(i)&&(n=i),a[e]={factory:n,inited:!1,exports:null}}function i(e){var i,s,o,l;if(i=a[e],s={},o={exports:{}},!t(i.factory))throw new Error("Module "+e+" has no factory.");if(l=i.factory.call(void 0,n,s,o),void 0!==l)i.exports=l;else if(o.hasOwnProperty("exports")&&"object"==typeof o.exports&&o.exports instanceof Object==!0){var c,r=!1;for(c in o.exports)o.exports.hasOwnProperty(c)&&(r=!0);r===!1?i.exports=s:i.exports=o.exports}else i.exports=o.exports;i.inited=!0}function n(t){var e;if(e=a[t],!e)throw new Error("Module "+t+" is not defined.");return e.inited===!1&&i(t),e.exports}var a={};e("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/cmt-notice-no-task-msg.js",function(t,e,i){window.changyan.api.ready(function(e){var i=e.util.jquery,n=t("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/model.js"),a=t("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/view.js"),s=t("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/control.js");s.bindModel(n).bindView(a),i(function(t){return function(){setTimeout(function(){t.init()},200)}}(s)),function(t){e.event.listen("changyan:login",function(){t.update()}),e.event.listen("changyan:logout",function(){t.update()}),e.event.listen("changyan:cmt-float-bar:ready",function(){t.updateView()}),e.event.listen("changyan:cy-user-info:render-my-finish",function(){t.execViewPlan(),t.updateView()}),e.event.listen("changyan:cy-user-page:close",function(){t.disableViewPlan()})}(s)})}),e("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/model.js",function(t,e,i){i.exports={tasks:{sumBubble:{num:0,invisible:!0},userInfoDot:{invisible:!0},userMsgDot:{invisible:!0,callback:function(t){t.resetStaticElement("message")}},userTskDot:{invisible:!0,callback:function(t){t.resetStaticElement("task")}},userInfoSupportBubble:{num:0,invisible:!0,callback:function(t){t.resetStaticElement("support")}},userInfoReplyBubble:{num:0,invisible:!0,callback:function(t){t.resetStaticElement("reply")}}},elements:{message:{"static":!0,type:"message",invisible:!0,data:{num:0}},support:{"static":!0,type:"support",invisible:!0,data:{num:0}},reply:{"static":!0,type:"reply",invisible:!0,data:{num:0}},task:{"static":!0,type:"task",invisible:!0,data:{num:0}}},elementPriority:["reply","support","message","task"],hist:{},update:function(t){for(var e in t)t.hasOwnProperty(e)&&this.updateElement(e,t[e].data);this.updateTasks()},getElements:function(){return this.elements},getElement:function(t){return this.elements[t]},addElement:function(t,e,i){this.elements[i]={type:t,data:e}},updateElement:function(t,e){this.elements.hasOwnProperty(t)?(this.elements[t].data=e,this.elements[t].invisible=!e.num):this.addElement("dynamic",e,t)},resetStaticElement:function(t){this.elements[t].invisible=!0,this.elements[t].data.num=0,this.updateTasks()},resetTask:function(t,e){if(this.tasks[t]){if(e)for(var i in e)this.tasks[t][i]=e[i];else this.tasks[t].invisible=!0,this.tasks[t].num&&(this.tasks[t].num=0);this.tasks[t].callback&&this.tasks[t].callback(this),this.updateTasks()}},deleteElement:function(t){delete this.elements[t]},updateTasks:function(){var t=this.elements.message.data.num,e=this.elements.support.data.num,i=this.elements.reply.data.num,n=this.elements.task.data.num;this.tasks.sumBubble.num=t+e+i+n,this.tasks.sumBubble.invisible=0==this.tasks.sumBubble.num,this.tasks.userInfoDot.invisible=e+i==0,this.tasks.userMsgDot.invisible=0==t,this.tasks.userTskDot.invisible=0==n,this.tasks.userInfoSupportBubble.num=e,this.tasks.userInfoSupportBubble.invisible=0==e,this.tasks.userInfoReplyBubble.num=i,this.tasks.userInfoReplyBubble.invisible=0==i}}}),e("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/view.js",function(t,e,i){window.changyan.api.ready(function(e){var n=e.util.jquery,a=e.util.velocityjs;t("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/cmt-notice.css");var s={jquery:n,_template:a,containerSelector:"#SOHUCS #SOHU_MAIN",container:null,instance:null,_model:null,tasks:{sumBubble:{type:1,hostSelector:".module-cmt-float-bar",targetSelector:".module-cmt-float-bar .user-info",clickPropagate:".module-cmt-float-bar .user-info img"},userInfoDot:{type:0,hostSelector:".module-cy-user-page",targetSelector:'.module-cy-user-page ul.cy-tab-list li[node-type="cy-info"]'},userMsgDot:{type:0,hostSelector:".module-cy-user-page",targetSelector:'.module-cy-user-page ul.cy-tab-list li[node-type="cy-notice"]',callback:function(t){n.ajax({url:e.getConfig("api")+"api/3/user/clear_unread/3",dataType:"jsonp",data:{client_id:e.getFeConfig("appid")},scriptCharset:"utf-8",success:function(t,e){return function(i){i.error_code||t.callbackToModel(e)}}(this,t)})}},userTskDot:{type:0,hostSelector:".module-cy-user-page",targetSelector:'.module-cy-user-page ul.cy-tab-list li[node-type="cy-task"]',callback:function(t){this.callbackToModel(t)}},userInfoSupportBubble:{type:1,hostSelector:".module-cy-user-page",targetSelector:".module-cy-user-page ul.cy-my-label li:nth-child(3) div.cy-my-label-item",callback:function(t){n.ajax({url:e.getConfig("api")+"api/3/user/clear_unread/2",dataType:"jsonp",data:{client_id:e.getFeConfig("appid")},scriptCharset:"utf-8",success:function(t,e){return function(i){i.error_code||t.callbackToModel(e)}}(this,t)})}},userInfoReplyBubble:{type:1,hostSelector:".module-cy-user-page",targetSelector:".module-cy-user-page ul.cy-my-label li:nth-child(2) div.cy-my-label-item",callback:function(t){n.ajax({url:e.getConfig("api")+"api/3/user/clear_unread/1",dataType:"jsonp",data:{client_id:e.getFeConfig("appid")},scriptCharset:"utf-8",success:function(t,e){return function(i){i.error_code||t.callbackToModel(e)}}(this,t)})}}},elements:{message:{"static":!0,template:"你收到<i>${num}</i>条新通知",action:["openUserPage","openMessage"],callback:function(){n.ajax({url:e.getConfig("api")+"api/3/user/clear_unread/3",data:{client_id:e.getFeConfig("appid")},dataType:"jsonp",scriptCharset:"utf-8"})}},support:{"static":!0,template:"你有<i>${num}</i>条评论收到赞同",action:["openUserPage","openUserInfo","openSupport"],callback:function(){n.ajax({url:e.getConfig("api")+"api/3/user/clear_unread/2",data:{client_id:e.getFeConfig("appid")},dataType:"jsonp",scriptCharset:"utf-8"})}},reply:{"static":!0,template:"你有<i>${num}</i>条新回复",action:["openUserPage","openUserInfo","openReply"],callback:function(){n.ajax({url:e.getConfig("api")+"api/3/user/clear_unread/1",data:{client_id:e.getFeConfig("appid")},dataType:"jsonp",scriptCharset:"utf-8"})}},task:{"static":!0,template:"你有<i>${num}</i>个任务已完成",action:["openUserPage","openTask"],callback:function(){}},dynamic:{template:"",callbackToModel:function(t,e){t.deleteElement(e)}}},actions:{immediate:{openUserPage:!0},openUserPage:function(t){return n(".module-cmt-header").length?n('.module-cmt-header div[node-type="avatar"]').length?(n('.module-cmt-header div[node-type="avatar"]').trigger("click"),1):0:-1},openUserInfo:function(t){return n(".module-cy-user-page").length?n(".module-cy-user-page .module-cy-user-info").length?(n('.module-cy-user-page .cy-user-page-tab li[node-type="cy-info"]').trigger("click"),1):0:-1},openMessage:function(t){return n(".module-cy-user-page").length?n(".module-cy-user-page .module-cy-user-notice").length?(n('.module-cy-user-page .cy-user-page-tab li[node-type="cy-notice"]').trigger("click"),1):0:-1},openSupport:function(t){return n(".module-cy-user-page").length?n(".module-cy-user-page .module-cy-user-info .cy-my-page-support").length?(n(".module-cy-user-page ul.cy-my-label li:nth-child(3) div.cy-my-label-item").trigger("click"),1):0:-1},openReply:function(t){return n(".module-cy-user-page").length?n(".module-cy-user-page .module-cy-user-info .cy-my-page-reply").length?(n(".module-cy-user-page ul.cy-my-label li:nth-child(2) div.cy-my-label-item").trigger("click"),1):0:-1},openTask:function(t){return n(".module-cy-user-page").length?n(".module-cy-user-page .module-cy-user-task").length?(n('.module-cy-user-page .cy-user-page-tab li[node-type="cy-task"]').trigger("click"),1):0:-1}},actionQueue:[],_toDoActions:!1,enableActions:function(){this._toDoActions=!0},disableActions:function(){this._toDoActions=!1},doActions:function(){function t(e,i,n){setTimeout(function(){if(!e.length)return void n.update();var a=e[0],s=i[a]();if(1==s)e.shift();else if(-1==s)return void(e.length=0);t(e,i,n)},200)}this._toDoActions&&t(this.actionQueue,this.actions,this)},_updateActionQueue:function(t){if(!t)var t=this._model;for(var e=0,i=t.elementPriority.length;i>e;e++)if(t.elements[t.elementPriority[e]].data.num>0)return void(this.actionQueue=this.elements[t.elementPriority[e]].action.slice(1));this.actionQueue=[]},bindModel:function(t){return this._model=t,this},_initTasks:function(){for(var t in this.tasks){var e=this.tasks[t];e.targetSelector&&(e.alias=t,e.host=function(){return n(this.hostSelector)},e.target=function(){return n(this.targetSelector)},e.clickPropagate||(e.clickPropagate=e.targetSelector),e.callbackToModel=function(t,e,i){if(!e)var e=this.alias;t.resetTask(e,i)},e.draw=function(t){var e=!t.num&&!t.hasOwnProperty("num"),i=this.target();if(!i||!i.length)return void setTimeout(function(t,e){return function(){var i=t.host();i&&i.length&&t.draw(e)}}(this,t),200);var a=e?"dot":"bubble";i=this.target().find(".module-cmt-notice-"+a),i.length<=0&&(i=n('<div class="module-cmt-notice-'+a+'"></div>'),i.data("alias",this.alias),this.target().append(i),this.target().css("position","relative")),i.css("display",t.invisible?"none":"inline-block"),e||i.text(t.num)})}},_initElements:function(){for(var t in this.elements){var e=this.elements[t];e["static"]&&(e.alias=t,e.callbackToModel=function(t){t.resetStaticElement(this.alias)})}},_adapt:function(t,e){return{alias:t,"static":e["static"]?"static":"dynamic",type:e.type,invisible:!!e.invisible,template:this._template.render(this.elements[e.type].template,e.data)}},_addElement:function(e,i){var a=this._template.render(t("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/item.html.js"),this._adapt(e,i));this._find("ul.nt-list").append(n(a))},_updateElementData:function(t,e){for(var i in e)e.hasOwnProperty(i)&&t.data(i,e[i])},_updateElement:function(t,e,i){var n=this._adapt(e,i);n.invisible?t.hide():t.show(),delete n.invisible,n.template&&(t.find('a[node-type="notice-content"]').html(n.template),delete n.template),this._updateElementData(t,n)},_find:function(t){return this.instance.find(t)},_getElements:function(){return this._find("ul.nt-list li")},ready:function(){return!!this.instance},init:function(e){if(this.instance)return void this.update();this._initTasks(),this._initElements();var i={elements:[]};for(var n in e.elements){var a=e.elements[n].type;a&&this.elements[a].template&&i.elements.push(this._adapt(n,e.elements[n]))}var s=this._template.render(t("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/cmt-notice.html.js"),i),o=this.jquery(s);this.instance=o,this.jquery(function(t){return function(){t.container=t.jquery(t.containerSelector),t.container.append(t.instance)}}(this)),this.update(e),this._bindEvents()},update:function(t){if(!t)var t=this._model;!function(t,e){for(var i in t)e[i]&&e[i].draw(t[i])}(t.tasks,this.tasks),function(t,e,i){e.each(function(){t.hasOwnProperty(n(this).data("alias"))||n(this).remove()});for(var a in t){for(var s=0,o=e.length;o>s;s++)if(n(e[s]).data("alias")==a){"static"==n(e[s]).data("static")&&i._updateElement(n(e[s]),a,t[a]);break}s==o&&i._addElement(a,t[a])}}(t.elements,this._getElements(),this),this._updateActionQueue(t)},_bindEvents:function(){!function(t,e,i,a){t.delegate("ul.nt-list li","click",function(t){a.enableActions();var e="li"===n(t.target)[0].tagName?n(t.target):n(t.target).closest("li");e.hide();var s=e.data("type"),o=i[s].action,l=0;if(o&&o.length){for(var c=0,r=o.length;r>c&&a.actions.immediate[o[c]];c++)a.actions[o[c]](),l++;a.actionQueue=o.slice(l)}}),t.delegate("ul.nt-list li a.nt-close","click",function(t){t.preventDefault(),t.stopPropagation();var s="li"===n(t.target)[0].tagName?n(t.target):n(t.target).closest("li");s.hide();var o=!1;if(o){var l=s.data("type");"static"==s.data("static")?i[l].callbackToModel(e):i.dynamic.callbackToModel(e,s.data("alias")),i[l].callback&&i[l].callback(),a.update()}})}(this.instance,this._model,this.elements,this),function(t,e,i){for(var a in i){var s=i[a];n(document).delegate(s.targetSelector+" .module-cmt-notice-"+(1==s.type?"bubble":"dot"),"click",function(t){return function(){n(t).trigger("click")}}(s.clickPropagate)),n(document).delegate(s.clickPropagate,"click",function(t,e,i){return function(n){e.enableActions(),t.callbackToModel(i,null,null),t.callback&&t.callback(i),e.update(i)}}(s,t,e))}}(this,this._model,this.tasks)},hidePopWin:function(){this._find("ul.nt-list li").hide()}};i.exports=s})}),e("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/cmt-notice.css",function(t,e,i){var n="#SOHUCS #SOHU_MAIN .module-cmt-notice-dot,.module-cmt-notice-dot{z-index:1000;display:block;width:4px;height:4px;background-color:#F74F4F;border-radius:2px;cursor:pointer}#SOHUCS #SOHU_MAIN .module-cmt-notice-bubble,.module-cmt-notice-bubble{z-index:1000;display:block;min-width:12px;height:16px;line-height:16px;padding:0 2px;text-align:center;font-size:12px;font-style:normal;font-family:arial;color:#FFF;background-color:#F74F4F;border-radius:8px;cursor:pointer}#SOHUCS #SOHU_MAIN .module-cmt-notice{position:fixed;right:0;bottom:0;padding:38px 0;font-family:'Microsoft YaHei';z-index:999999}#SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list{max-width:300px;text-align:right;overflow:visible;position:relative}#SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item{position:relative;display:inline-block;overflow:auto;max-width:200px;min-width:170px;line-height:24px;background-color:#f8f9f9;color:#000!important;margin:5px 10px;padding:10px 35px 10px 30px;border:1px solid #e9f0f5;border-top-color:#e9f0f5;border-right-color:#d6dde1;border-bottom-color:#d6dde1;border-left-color:#e9f0f5;text-decoration:none;cursor:pointer;font-size:15px}#SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item .nt-text{color:#000!important;text-decoration:none}#SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item .nt-text i{color:#f74f4f!important;padding:0 4px}#SOHUCS #SOHU_MAIN .module-cmt-notice .nt-close{display:inline-block;position:absolute;right:12px;top:12px;width:10px;height:10px;background:transparent url(//changyan.sohu.com/mdevp/extensions/cmt-notice-no-task-msg/001/images/close.gif) repeat-x scroll 0 0}#SOHUCS #SOHU_MAIN .module-cmt-notice .nt-close:hover{background-position:-10px 0}.module-cy-user-page .module-cmt-notice-dot{position:absolute;top:0;right:6px;width:6px;height:6px;background-color:#F74F4F;border-radius:6px}.module-cy-user-page .module-cmt-notice-bubble{display:inline-block;position:absolute;min-width:12px;height:16px;line-height:16px;padding:0 2px;text-align:center;font-size:12px;font-style:normal;font-family:arial;color:#FFF;background-color:#F74F4F;border-radius:16px;margin-left:4px}.module-cmt-float-bar .module-cmt-notice-bubble{position:absolute;top:-8px;*top:-4px;left:20px;min-width:12px;height:16px;line-height:16px;padding:0 2px;text-align:center;font-size:12px;font-style:normal;font-family:arial;color:#FFF;background-color:#F74F4F;border-radius:8px}",a=window.document,s=a.createElement("style");s.setAttribute("type","text/css"),a.all?s.styleSheet.cssText=n:s.innerHTML=n,a.getElementsByTagName("head").item(0).appendChild(s)}),e("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/item.html.js",function(t,e,i){"use strict";var n;return n=[],n.push('<li node-type="notice-${alias}" data-alias="${alias}" data-type="${type}" data-static="${static}" class="nt-item" style="#if(${invisible}) display: none #else #end">'),n.push('    <a node-type="notice-content" class="nt-text" href="javascript:void(0);">${template}</a>'),n.push('    <a class="nt-close" href="javascript:void(0);"></a>'),n.push("</li>"),n.join("\n")}),e("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/cmt-notice.html.js",function(t,e,i){"use strict";var n;return n=[],n.push('<div class="module-cmt-notice">'),n.push('    <ul class="nt-list">'),n.push("        #foreach ($el in ${elements})"),n.push('        <li node-type="notice-${el.alias}" data-alias="${el.alias}" data-type="${el.type}" data-static="${el.static}" class="nt-item" style="#if(${el.invisible}) display: none #else #end">'),n.push('            <a node-type="notice-content" class="nt-text" href="javascript:void(0);">${el.template}</a>'),n.push('            <a class="nt-close" href="javascript:void(0);"></a>'),n.push("        </li>"),n.push("        #end"),n.push("    </ul>"),n.push("</div>"),n.join("\n")}),e("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/control.js",function(t,e,i){window.changyan.api.ready(function(t){var e=t.util.jquery,n=(t.util.velocityjs,{ifPoll:!1,intervalId:null,cycle:1e3,tasks:[{api:t.getConfig("api")+"api/3/user/get_unread_profile",_debug:!1,_model:{latest_message_count:1,latest_support_count:3,latest_reply_count:2,latest_task_count:1},callback:function(t,e){t.update({message:{type:"message",data:{num:e.latest_message_count||0}},support:{type:"support",data:{num:e.latest_support_count||0}},reply:{type:"reply",data:{num:e.latest_reply_count||0}}})},eventKey:null}],execViewPlan:function(){this._view.doActions()},disableViewPlan:function(){this._view.disableActions()},_model:null,_view:null,bindModel:function(t){return this._model=t,this._view&&this._view.bindModel(t),this},bindView:function(t){return this._view=t,this._model&&this._view.bindModel(this._model),this},updateView:function(){return this._initialized?void this._view.update(this._model):void this.init()},_execTasks:function(){var i=this;for(var n in this.tasks)this.tasks[n]._debug?(this.tasks[n].callback(this._model,this.tasks[n]._model),this.updateView()):e.ajax({url:this.tasks[n].api,data:{client_id:t.getFeConfig("appid")},dataType:"jsonp",scriptCharset:"utf-8",success:function(t,e){return function(n){return n.error_code?void i._view.hidePopWin():(e.callback(t._model,n),void t.updateView())}}(this,this.tasks[n])})},_poll:function(){this.intervalId&&this._abortPoll(),this.intervalId=self.setInterval(function(t){return function(){t.update()}}(this),this.cycle)},update:function(){return this._initialized?void this._execTasks():void this.init()},_initialized:!1,init:function(){this._initialized||(this._initialized=!0,this._view.init(this._model),this.ifPoll?this._poll():this.update())},_abortPoll:function(){window.clearInterval(this.intervalId)}});i.exports=n})}),i("C:/Users/Administrator/AppData/Roaming/npm/node_modules/mdevp/cache/www/cmt-notice-no-task-msg/cmt-notice-no-task-msg.js")}();